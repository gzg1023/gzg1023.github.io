<!DOCTYPE html>
<html lang='zh' ><meta charset="utf-8">
<meta name="viewport" content="width=device-width">


<title>ã€æŠ€æœ¯åˆ†äº«ã€‘å…¥é—¨æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ | æ²½é»˜æ¸…å°˜</title>
<link rel="stylesheet" href="/css/eureka.min.css">
<script defer src="/js/eureka.min.js"></script>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/styles/solarized-light.min.css"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/highlight.min.js"
   crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js"
   integrity="sha256-uNYoXefWRqv&#43;PsIF/OflNmwtKM4lStn9yrz2gVl6ymo="  crossorigin></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
   integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3&#43;Aro6EYUG4&#43;cU&#43;KJWu/X"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" 
  integrity="sha384-g7c&#43;Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI&#43;sEnkvrMWph2EDg4"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
   integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC&#43;Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_hu4dd3a7947c4cdf24f3f1440430310555_390_32x32_fill_box_center_2.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon_hu4dd3a7947c4cdf24f3f1440430310555_390_180x180_fill_box_center_2.png">

<meta name="description"
  content="
æ—¥å¸¸å¼€å‘è€…ç»å¸¸ç¢°åˆ°éœ€è¦ä¼˜åŒ–çš„éœ€æ±‚ï¼Œé™¤äº†ä¸€äº›æ—¥å¸¸çš„åˆ¤æ–­å’Œå¾ªç¯åŠå„ç§ç›‘å¬ï¼Œäº†è§£ä¸€ä¸‹æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ã€‚
">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"Posts",
      "item":"/posts/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"ã€æŠ€æœ¯åˆ†äº«ã€‘å…¥é—¨æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡",
      "item":"/posts/2021/observer/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/posts/2021/observer/"
    },
    "headline": "ã€æŠ€æœ¯åˆ†äº«ã€‘å…¥é—¨æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ | æ²½é»˜æ¸…å°˜","datePublished": "2021-04-01T00:00:00+00:00",
    "dateModified": "2021-04-01T00:00:00+00:00",
    "wordCount":  430 ,
    "publisher": {
        "@type": "Person",
        "name": "gzg1023",
        "logo": {
            "@type": "ImageObject",
            "url": "https://i.loli.net/2021/03/06/kHzcVZrX2uDW6Jg.jpg"
        }
        },
    "description": "\u003cblockquote\u003e\n\u003cp\u003eæ—¥å¸¸å¼€å‘è€…ç»å¸¸ç¢°åˆ°éœ€è¦ä¼˜åŒ–çš„éœ€æ±‚ï¼Œé™¤äº†ä¸€äº›æ—¥å¸¸çš„åˆ¤æ–­å’Œå¾ªç¯åŠå„ç§ç›‘å¬ï¼Œäº†è§£ä¸€ä¸‹æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ã€‚\u003c\/p\u003e\n\u003c\/blockquote\u003e"
}
</script><meta property="og:title" content="ã€æŠ€æœ¯åˆ†äº«ã€‘å…¥é—¨æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ | æ²½é»˜æ¸…å°˜" />
<meta property="og:type" content="article" />


<meta property="og:image" content="/images/favicon.png">


<meta property="og:url" content="/posts/2021/observer/" />




<meta property="og:description" content="
æ—¥å¸¸å¼€å‘è€…ç»å¸¸ç¢°åˆ°éœ€è¦ä¼˜åŒ–çš„éœ€æ±‚ï¼Œé™¤äº†ä¸€äº›æ—¥å¸¸çš„åˆ¤æ–­å’Œå¾ªç¯åŠå„ç§ç›‘å¬ï¼Œäº†è§£ä¸€ä¸‹æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ã€‚
" />




<meta property="og:locale" content="zh" />




<meta property="og:site_name" content="æ²½é»˜æ¸…å°˜" />






<meta property="article:published_time" content="2021-04-01T00:00:00&#43;00:00" />


<meta property="article:modified_time" content="2021-04-01T00:00:00&#43;00:00" />



<meta property="article:section" content="posts" />


<meta property="article:tag" content="å‰ç«¯" />

<meta property="article:tag" content="æ€§èƒ½ä¼˜åŒ–" />





<meta property="og:see_also" content="/posts/2021/vue_principle_01/" />

<meta property="og:see_also" content="/posts/2021/snabbdom_source/" />

<meta property="og:see_also" content="/posts/2021/input_html/" />

<meta property="og:see_also" content="/posts/2021/designpatterns/" />

<meta property="og:see_also" content="/posts/2020/scroll_fix/" />

<meta property="og:see_also" content="/posts/2020/functional_programming/" />



<body class="flex flex-col min-h-screen">
  <header class="fixed flex items-center w-full min-h-16 pl-scrollbar z-50 bg-secondary-bg shadow-sm">
    <div class="w-full max-w-screen-xl mx-auto"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="mr-6 text-primary-text text-xl font-bold">æ²½é»˜æ¸…å°˜</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/posts/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  mr-4">Posts</a>
            <a href="/tags/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  mr-4">Tags</a>
            <a href="/docs/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  mr-4">Docs</a>
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka">Light</span>
                    <span class="px-4 py-1 hover:text-eureka">Dark</span>
                    <span class="px-4 py-1 hover:text-eureka">Auto</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            switchMode('Auto')
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script></div>
  </header>
  <main class="flex-grow pt-16">
    <div class="pl-scrollbar">
      <div class="w-full max-w-screen-xl lg:px-4 xl:px-8 mx-auto">


<div class="grid grid-cols-2 lg:grid-cols-8 gap-4 lg:pt-12">
    <div
        class="col-span-2  lg:col-span-6 bg-secondary-bg rounded px-6 py-8">
        <h1 class="font-bold text-3xl text-primary-text">ã€æŠ€æœ¯åˆ†äº«ã€‘å…¥é—¨æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡</h1>
        <div class="flex flex-wrap flex-row items-center mt-2 text-tertiary-text">
    <div class="mr-6 my-2">
        <i class="fas fa-calendar mr-1"></i>
        <span>2021-04-01</span>
    </div>
    
    
    
    <div class="mr-6 my-2">
        <i class="fas fa-folder mr-1"></i>
        
        <a href="/categories/%E5%89%8D%E7%AB%AF/" class="hover:text-eureka">å‰ç«¯</a>
        
        
        <span>, </span>
        <a href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="hover:text-eureka">æ€§èƒ½ä¼˜åŒ–</a>
        
    </div>
    

    
</div>
        
        
        

        <div class="content">
            <blockquote>
<p>æ—¥å¸¸å¼€å‘è€…ç»å¸¸ç¢°åˆ°éœ€è¦ä¼˜åŒ–çš„éœ€æ±‚ï¼Œé™¤äº†ä¸€äº›æ—¥å¸¸çš„åˆ¤æ–­å’Œå¾ªç¯åŠå„ç§ç›‘å¬ï¼Œäº†è§£ä¸€ä¸‹æµè§ˆå™¨é‡Œé¢çš„å„ç§Observerå¯¹è±¡ã€‚</p>
</blockquote>
<h2 id="éœ€æ±‚æ¥æº">éœ€æ±‚æ¥æº</h2>
<p>å¾ˆæ—©ä¹‹å‰äº§å“æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦åœ¨ç®¡ç†ç³»ç»Ÿçš„é¡µé¢åˆ¶ä½œä¸€ä¸ªæ°´å°ï¼Œä½†æ˜¯ä¸å…è®¸ç”¨æˆ·æ‰‹åŠ¨æ›´æ”¹é¡µé¢æ¥å£ï¼Œåˆ é™¤æ°´å°ã€‚é‚£ä¹ˆå°±ç”¨åˆ°<code>MutationObserver</code>è¿™ä¸ªapiäº†ï¼Œå¯ä»¥ç›‘å¬DOMçš„å˜åŒ–ï¼Œä»è€Œå¯¹ç”¨æˆ·çš„ä¿®æ”¹åšå‡ºååº”ã€‚</p>
<p>æœ€è¿‘æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦å®æ—¶å¤„ç†é¡µé¢æ»šåŠ¨å†…å®¹çš„æƒ…å†µï¼Œäºæ˜¯æƒ³åˆ°äº†ç”¨<code>getComputedStyle</code>æ¥è·å–DOMçš„ä½ç½®ï¼Œåœ¨chromeæ¨¡æ‹Ÿå™¨åšäº†ä¸€ä¸ªdemoæ„Ÿè§‰æ•ˆæœä¹Ÿè¿˜è¡Œã€‚äºæ˜¯æ‰“å¼€appæ”¾åˆ°<code>webview</code>é‡Œé¢æµ‹è¯•ï¼Œåˆšè®¿é—®é¡µé¢çš„ä¸€ç¬é—´appå´©æºƒæ‰äº†ã€‚æˆ‘è¿˜æ²¡ååº”è¿‡æ¥ï¼Œé‡æ–°è®¿é—®ä¸€æ¬¡åˆå´©æºƒäº†ã€‚ç™¾æ€ä¸è§£ï¼Œæˆ‘æ³¨é‡Šäº†è¿™æ®µå†…å®¹é‡Œé¢å¯ä»¥è®¿é—®äº†ï¼Œå› ä¸ºè¿˜éœ€è¦æ‰¾å…¶ä»–åŒäº‹æ’æŸ¥å´©æºƒåŸå› ï¼Œäºæ˜¯å¯»æ‰¾æ–°çš„è§£å†³åŠæ³•ç„¶åå°±æœç´¢åˆ°äº†<code>IntersectionObserver</code> è¿™ä¸ªapiã€‚å‡ è¡Œä»£ç å°±å®ç°äº†ç›‘å¬ï¼Œå¹¶ä¸”æ€§èƒ½ä¹Ÿè¿˜ä¸é”™ï¼Œappä¹Ÿæ²¡å´©æºƒã€‚</p>
<p>è§£å†³äº†æ»‘åŠ¨çš„éœ€æ±‚ï¼Œå‘ç°è‡ªå·±å¯¹å„ç§<code>Observer</code>çš„apiä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæœ‰çš„ç”šè‡³æ²¡å¬è¯´è¿‡ã€‚äºæ˜¯å†™äº†æœ¬ç¯‡æ–‡ç« æ€»ç»“ä¸€äº›æµè§ˆå™¨ä¸­å¥½ç”¨çš„<code>Observer api</code>ã€‚</p>
<h2 id="å„ç§observer">å„ç§Observer</h2>
<p>åœ¨æ²¡æœ‰æœç´¢MDNä¹‹å‰ï¼Œæˆ‘åªå¬è¯´è¿‡ä¸ªåˆ«apiï¼Œæ²¡æƒ³åˆ°è¿˜æœ‰è¿™ä¹ˆå¤š(çœ¼ç•Œå¤ªä½äº†)ã€‚è¿™äº›æµè§ˆå™¨apiéƒ½æ˜¯æµè§ˆå™¨æä¾›çš„é«˜æ€§èƒ½api ä¸“é—¨é’ˆå¯¹æŸä¸€äº›é¢‘ç¹æ“ä½œ/æ¶ˆè€—æ€§èƒ½ ä¸“é—¨è¿›è¡Œä¼˜åŒ–çš„apiï¼Œå…³äºå„ç§<code>Observer</code>éƒ½æ˜¯å¾®ä»»åŠ¡ï¼Œåœ¨æµè§ˆå™¨ç©ºé—²é˜¶æ®µè§¦å‘ï¼Œæ‰€ä»¥æ€§èƒ½è¦æ¯”åŒæ­¥ä»»åŠ¡é«˜å¾ˆå¤šã€‚æµè§ˆå™¨å…¼å®¹æ–¹é¢ä¹Ÿå¾ˆä¸é”™ï¼Œé™¤äº†è€IE å¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨éƒ½å¯ä»¥ç”¨ã€‚åœ¨ç§»åŠ¨ç«¯æ›´æ˜¯å¯ä»¥å¤§å±•èº«æ‰‹ã€‚</p>
<p>æ‰“å¼€MDNæœç´¢Observerå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šapiï¼Œè¿™é‡Œæˆ‘æ‹¿å‡ºå‡ ä¸ªå¸¸ç”¨çš„è¿›è¡Œåˆ†æï¼Œå…¶ä»–çš„æœ‰éœ€æ±‚æ—¶å€™å¯ä»¥åœ¨çœ‹æ–‡æ¡£ã€‚</p>
<ul>
<li>MutationObserver ç›‘è§†DOMæ ‘ä¿®æ”¹</li>
<li>IntersectionObserver è§‚å¯Ÿç›®æ ‡å…ƒç´ çŠ¶æ€</li>
<li>PerformanceObserver ç›‘æµ‹æ€§èƒ½åº¦é‡</li>
<li>ResizeObserver ç›‘è§†å…ƒç´ çš„å¤§å°æ›´æ”¹</li>
</ul>
<h2 id="mutationobserver">MutationObserver</h2>
<p><code>MutationObserver</code>çš„ä½œç”¨æ˜¯ç›‘å¬DOMæ ‘çš„å˜åŒ–ï¼Œæ— è®ºæ˜¯ä¿®æ”¹<code>css</code>è¿˜æ˜¯æ·»åŠ ä¸€ä¸ª<code>pæ ‡ç­¾</code>ï¼Œéƒ½åœ¨<code>MutationObserver</code>çš„ç®¡æ§ä¸‹ã€‚å¯¹äºDOMæ ‘çš„ä¿®æ”¹ä¸€èˆ¬æ¥è¯´åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯é¢„è®¾çš„domè·¯å¾„ï¼Œæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åŠ¨æ€åˆ›å»ºä¸€ä¸ªå¼¹çª—ï¼Œæˆ–è€…æ˜¯æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€æ·»åŠ çš„æ•°æ®é¡¹ã€‚
å¦å¤–ä¸€ç§æ˜¯é¢„è®¾ä¹‹å¤–çš„æƒ…å†µï¼Œæ¯”å¦‚ç”¨æˆ·æ‰“å¼€<code>F12å¼€å‘è€…é¢æ¿</code>ï¼Œåœ¨è‡ªå·±çš„æµè§ˆå™¨å¯¹é¡µé¢ä¸´æ—¶ä¿®æ”¹æ ·å¼ç­‰ã€‚</p>
<p>ä¸åŒçš„æƒ…å†µå¯¹åº”ä¸åŒçš„éœ€æ±‚ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€ç§æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>MutationObserver</code>æ¥è®¡åˆ’è¡ŒåŠ¨ç›‘å¬DOMåŒºåŸŸçš„å˜åŒ–ï¼Œè€Œä¸”ä¸æ˜¯å®æ—¶åˆ¤æ–­ä¸€ä¸ªDOMåŒºåŸŸçš„å€¼æ˜¯å¦äº§ç”Ÿæ¥å˜åŒ–æ¥è§£å†³æ€§èƒ½æ¶ˆè€—çš„é—®é¢˜ï¼Œç¬¬äºŒç§æƒ…å†µå¯ä»¥ç”¨ç½‘é¡µæ°´å°ï¼Œé˜²æ­¢ç”¨æˆ·ç¯¡æ”¹ã€‚</p>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£å°±æ¥çœ‹çœ‹æ€ä¹ˆç”¨å§.</p>
<h3 id="åˆ›å»ºmutationobserveré…ç½®å’Œå®ä¾‹">åˆ›å»ºMutationObserveré…ç½®å’Œå®ä¾‹</h3>
<p>å¯¹äºè§‚å¯ŸDOMçš„éœ€æ±‚ï¼Œç¬¬ä¸€æ­¥è‚¯å®šå…ˆæŒ‡å®štargetNodeä½œä¸ºéœ€è¦è§‚å¯Ÿçš„å¯¹è±¡äº†ï¼Œç„¶åæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ª<code>observerOptions</code>é…ç½®å¯¹è±¡ï¼Œæ¥é…ç½®<code>MutationObserver</code>çš„è§‚å¯Ÿç›®æ ‡é…ç½®ã€‚ç„¶åå°±æ˜¯é€šè¿‡new æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</p>
<pre><code class="language-javascript">let targetNode = document.getElementById('index-page')
let observerOptions = {
    attributeFilter: ['list', 'attribute'], // å­—ç¬¦ä¸²æ•°ç»„ï¼Œç”¨äºæŒ‡å®šè¦ç›‘å¬å˜åŒ–çš„å±æ€§åç§°,å¦‚æœæŒ‡å®šäº†ä¼šæ— è§†attributes
    attributeOldValue: true, // å¸ƒå°”å€¼ï¼Œ è®°å½•ä»»ä½•æœ‰æ”¹åŠ¨çš„å±æ€§çš„ä¸Šä¸€ä¸ªå€¼
    childList: true, // å¸ƒå°”å€¼ï¼Œè§‚å¯Ÿç›®æ ‡å­èŠ‚ç‚¹çš„å˜åŒ–ï¼Œæ˜¯å¦æœ‰æ·»åŠ æˆ–è€…åˆ é™¤
    attributes: true, //  å¸ƒå°”å€¼ï¼Œè§‚å¯Ÿå…ƒç´ çš„å±æ€§å€¼å˜æ›´
    characterData: false, // å¸ƒå°”å€¼ï¼Œ ç›‘è§†æŒ‡å®šç›®æ ‡èŠ‚ç‚¹æˆ–å­èŠ‚ç‚¹æ ‘ä¸­èŠ‚ç‚¹æ‰€åŒ…å«çš„å­—ç¬¦æ•°æ®çš„å˜åŒ–
    characterDataOldValue: false, // å¸ƒå°”å€¼ï¼Œ åœ¨æ–‡æœ¬åœ¨å—ç›‘è§†èŠ‚ç‚¹ä¸Šå‘ç”Ÿæ›´æ”¹æ—¶è®°å½•èŠ‚ç‚¹æ–‡æœ¬çš„å…ˆå‰å€¼
    subtree: true // / å¸ƒå°”å€¼,è§‚å¯Ÿæ‰€æœ‰åä»£èŠ‚ç‚¹(å­™èŠ‚ç‚¹)ï¼Œé»˜è®¤ä¸º false
}
// åˆ›å»ºè§‚å¯Ÿå¯¹è±¡ï¼Œå¹¶æŒ‡å®šcallbackå‡½æ•°
let observerObj = new MutationObserver(callback)
</code></pre>
<h3 id="å¯åŠ¨åœæ­¢mutationobserverç›‘å¬">å¯åŠ¨/åœæ­¢MutationObserverç›‘å¬</h3>
<p>åœ¨åˆ›å»ºå®ŒMutationObserverå’Œå®ä¾‹åï¼Œé€šè¿‡æˆ‘ä»¬è¿›è¡Œå¼€å§‹å’Œåœæ­¢çš„æ“ä½œ</p>
<pre><code class="language-javascript">// é€šè¿‡observeæ–¹æ³•å¯åŠ¨è§‚å¯Ÿï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦è§‚å¯Ÿçš„èŠ‚ç‚¹ï¼Œç¬¬äºŒä¸ªæ˜¯è§‚å¯Ÿé…ç½®ä¿¡æ¯
observerObj.observe(targetNode, observerOptions)

// é€šè¿‡disconnectæ¥åœæ­¢è§‚å¯Ÿï¼Œå¹¶ä¸”å¯ä»¥å†æ¬¡è°ƒç”¨observeå¼€å¯
observerObj.disconnect()

// é€šè¿‡takeRecordsæ¥æ¸…ç©ºå½“å‰çš„è§‚å¯Ÿé˜Ÿåˆ—ï¼Œå¹¶è¿”å›å·²æ£€æµ‹åˆ°ä½†å°šæœªå¤„ç†çš„DOMæ›´æ”¹çš„åˆ—è¡¨
observerObj.takeRecords()
</code></pre>
<h3 id="mutationobserverçš„calback">MutationObserverçš„calback</h3>
<p>åœ¨åˆ›å»ºå®Œæˆåï¼Œå¹¶å¯åŠ¨åˆ›å»ºçš„å®ä¾‹åï¼Œæ¯æ¬¡å˜åŒ–éƒ½ä¼šè°ƒç”¨<code>callbackå‡½æ•°</code>ï¼Œæˆ‘ä»¬æ¯æ¬¡æ‹¿åˆ°çš„æ˜¯DOMå˜åŒ–çš„<code>mutationæ•°ç»„</code>ï¼Œæ¯ä¸€å¯¹è±¡éƒ½ä¼šå­˜åœ¨ä»¥ä¸‹çš„å±æ€§ï¼Œç„¶åå°±å¯ä»¥æ„‰å¿«çš„è¿›è¡Œé€»è¾‘å¤„ç†äº†ã€‚</p>
<pre><code class="language-javascript">// mutationsList DOMå˜åŒ–æ•°ç»„ï¼Œæ¯ä¸€é¡¹ä»£è¡¨ä¸€ä¸ªDOMçš„ç‹¬ç«‹å˜åŒ–
// observer è§‚å¯Ÿè€…çš„å®ä¾‹
const callback = (mutationsList, observer) =&gt; {
    let mutation = mutationsList[0] 
    // æ¯ä¸€ä¸ªè¿”å›mutationèŠ‚ç‚¹
    mutation = {
        addedNodes: ' NodeList [comment]', // è¢«æ·»åŠ çš„èŠ‚ç‚¹
        attributeName: null, // è¢«ä¿®æ”¹çš„å±æ€§çš„å±æ€§å
        attributeNamespace: null, // è¢«ä¿®æ”¹å±æ€§çš„å‘½åç©ºé—´
        nextSibling: 'div', // è¢«æ·»åŠ æˆ–ç§»é™¤çš„èŠ‚ç‚¹ä¹‹åçš„å…„å¼ŸèŠ‚ç‚¹
        oldValue: null, // æ ¹æ®typeè¿”å›å€¼
        previousSibling: 'text', // è¢«æ·»åŠ æˆ–ç§»é™¤çš„èŠ‚ç‚¹ä¹‹å‰çš„å…„å¼ŸèŠ‚ç‚¹
        removedNodes: ' NodeList []', // è¿”å›è¢«ç§»é™¤çš„èŠ‚ç‚¹ã€‚
        target: 'div.limit-lottery-box', // å˜åŒ–å½±å“çš„èŠ‚ç‚¹
        type: 'childList' // å˜åŒ–çš„ç±»å‹ ã€‚å±æ€§å˜åŒ–ï¼Œè¿”å› &quot;attributes&quot;
    } 
}
</code></pre>
<h2 id="intersectionobserver">IntersectionObserver</h2>
<p><code>IntersectionObserver</code>å­¦åå« äº¤å‰è§‚å¯Ÿå™¨ï¼Œç®€å•æ¥è¯´å°±æ˜¯æŒ‡å®šä¸€ä¸ªDOMå…ƒç´ ç„¶åè§‚å¯Ÿä½ç½®å˜åŒ–ï¼Œç„¶åæ ¹æ®è‡ªå·±çš„éœ€æ±‚åšå‡ºå¤„ç†ã€‚</p>
<h3 id="åˆ›å»ºintersectionobserver">åˆ›å»ºIntersectionObserver</h3>
<p>é€šè¿‡newåˆ›å»º<code>IntersectionObserver</code>å®ä¾‹ï¼Œç¬¬ä¸€æ¬¡å‚æ•°æ˜¯å›è°ƒå‡½æ•°ï¼Œåœ¨åˆ°è¾¾æŒ‡å®šé˜€å€¼çš„æ—¶å€™è§¦å‘ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é…ç½®å¯¹è±¡</p>
<pre><code class="language-javascript">let targetNode = document.getElementById('index-page')
let option = {
    root: document.documentElement, // ç›‘å¬å…ƒç´ çš„ç¥–å…ˆå…ƒç´ Elementå¯¹è±¡
    rootMargin: '0px 0px 0px 0px', //åœ¨è®¡ç®—äº¤å‰å€¼æ—¶æ·»åŠ è‡³æ ¹çš„è¾¹ç•Œç›’ä¸­çš„ä¸€ç»„åç§»é‡
    threshold:[0.1ï¼Œ0.5.1.0] // ç›‘å¬ç›®æ ‡ä¸è¾¹ç•Œç›’äº¤å‰åŒºåŸŸçš„æ¯”ä¾‹(é˜ˆå€¼)
}
let intersectionObj = new IntersectionObserver(callback,option)
</code></pre>
<h3 id="å¯åŠ¨å…³é—­intersectionobserverå®ä¾‹">å¯åŠ¨/å…³é—­IntersectionObserverå®ä¾‹</h3>
<pre><code class="language-javascript">// é€šè¿‡observeæ–¹æ³•å¯åŠ¨è§‚å¯Ÿ,æŒ‡å®šä¸€ä¸ªè§‚å¯Ÿçš„å…ƒç´ èŠ‚ç‚¹,æ­¤å…ƒç´ å¿…é¡»æ˜¯æ ¹å…ƒç´ çš„åä»£å¤šæ¬¡è°ƒç”¨å³å¯è§‚å¯Ÿå¤šä¸ªDOMèŠ‚ç‚¹
intersectionObj.observe(targetNode)

// é€šè¿‡disconnectæ¥åœæ­¢å…¨éƒ¨è§‚å¯Ÿ
intersectionObj.disconnect()

// é€šè¿‡takeRecordsæ¸…é™¤æŒ‚èµ·çš„ç›¸äº¤çŠ¶æ€åˆ—è¡¨ã€‚è¿”å›ä¸€ä¸ª IntersectionObserverEntry å¯¹è±¡æ•°ç»„, æ¯ä¸ªå¯¹è±¡çš„ç›®æ ‡å…ƒç´ éƒ½åŒ…å«æ¯æ¬¡ç›¸äº¤çš„ä¿¡æ¯, å¯ä»¥æ˜¾å¼é€šè¿‡è°ƒç”¨æ­¤æ–¹æ³•æˆ–éšå¼åœ°é€šè¿‡è§‚å¯Ÿè€…çš„å›è°ƒè‡ªåŠ¨è°ƒç”¨.
intersectionObj.takeRecords()

// åœæ­¢å¯¹ä¸€ä¸ªå…ƒç´ çš„è§‚å¯Ÿ
intersectionObj.unobserve(targetNode)
</code></pre>
<h3 id="intersectionobserverçš„callback">IntersectionObserverçš„callback</h3>
<p>å›è°ƒå‡½æ•°ï¼Œå½“è§¦å‘æ»‘åŠ¨è·ç¦»å‘ç”Ÿåå·®æ—¶å€™è§¦å‘ã€‚</p>
<pre><code class="language-javascript">// entriesList IntersectionObserverEntryå¯¹è±¡çš„æ•°ç»„
// observer è§‚å¯Ÿè€…çš„å®ä¾‹
const callback = (entriesList, observer) =&gt; {
    let entrie = entriesList[0] 
    entrie = {
        // åŒ…å«ç›®æ ‡å…ƒç´ çš„è¾¹ç•Œä¿¡æ¯çš„å€¼ä¸  Element.getBoundingClientRect() ç›¸åŒ
        boundingClientRect: DOMRectReadOnly {x: 0, y: -76, width: 1, height: 75, top: -76 â€¦}
        // intersectionRect ä¸ boundingClientRect çš„æ¯”ä¾‹å€¼.å®Œå…¨å¯è§æ—¶ä¸º1ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºç­‰äº0
        intersectionRatio: 0
        // DOMRectReadOnly ç”¨æ¥æè¿°æ ¹å’Œç›®æ ‡å…ƒç´ çš„ç›¸äº¤åŒºåŸŸ
        intersectionRect: DOMRectReadOnly {x: 0, y: 0, width: 0, height: 0, top: 0, â€¦}
        // å¸ƒå°”ï¼Œç›®æ ‡å…ƒç´ ä¸äº¤å‰åŒºåŸŸè§‚å¯Ÿè€…å¯¹è±¡çš„æ ¹ç›¸äº¤ä¸ºtrue å¦åˆ™false
        isIntersecting: false
        // æš‚æ— ä»‹ç»
        isVisible: false
        // æ ¹å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯
        rootBounds: DOMRectReadOnly {x: 0, y: 0, width: 375, height: 812, top: 0, â€¦}
        // æ ¹å‡ºç°ç›¸äº¤åŒºåŸŸæ”¹å˜çš„å…ƒç´ 
        target: DOM
        // å¯è§æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶é—´
        time: 3445.7450000045355
    } 
}
</code></pre>
<h3 id="intersectionobserverå®ç°æ— é™æ»šåŠ¨">IntersectionObserverå®ç°æ— é™æ»šåŠ¨</h3>
<p>åŸºäºvueå®ç°å»ºè®®ç‰ˆé«˜æ€§èƒ½æ— é™æ»šåŠ¨ç»„ä»¶,so easy æœ‰æœ¨æœ‰ï¼</p>
<pre><code class="language-javascript">
// infiniteLoad.vue ç»„ä»¶
&lt;template&gt;
  &lt;div class=&quot;infiniteLoad&quot;&gt;
    &lt;slot&gt;
    &lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'infiniteLoad',
  data () {
    return {
    }
  },
  mounted () { 
    let intersectionObserver = new IntersectionObserver((entries)=&gt; {
    console.log(entries)
    if (entries[0].intersectionRatio &lt;= 0) return;
        this.$emit('loadmore')
      });
    intersectionObserver.observe(document.querySelector('.infiniteLoad'));
  }
}
&lt;/script&gt;


// ä½¿ç”¨

import  infiniteLoad  from &quot;../components/infiniteLoad.vue&quot;

&lt;infinite-load
    @loadmore=&quot;loadmore&quot;
&gt;&lt;/infinite-load&gt;

loadmore() {
    console.log('loadMore')
}

</code></pre>
<h2 id="performanceobserver">PerformanceObserver</h2>
<p><code>PerformanceObserver</code>è¿˜ä¸å¤ªç†Ÿæ‚‰ï¼Œä¹Ÿæ²¡ç¢°åˆ°åº”ç”¨åœºæ™¯ã€‚å…ˆçŸ¥é“æœ‰è¿™ä¸ªä¸œè¥¿ï¼Œä¸‹æ¬¡ä¸€å®šã€‚ğŸ˜¬</p>
<h2 id="resizeobserver">ResizeObserver</h2>
<p>è¿™ä¸ªapiåŠŸèƒ½å’Œ<code>window.resize</code>ç±»ä¼¼ï¼Œä½†æ˜¯å…·æœ‰æ›´é«˜çš„æ€§èƒ½ã€‚ä¸»è¦ç”¨æ¥ç›‘å¬å…ƒç´ çš„å¤§å°æ›´æ”¹ï¼Œå¯ä»¥è§‚å¯Ÿæ™®é€šdomå…ƒç´ å’Œsvgå…ƒç´ ã€‚</p>
<h3 id="åˆ›å»ºresizeobserverå®ä¾‹">åˆ›å»ºResizeObserverå®ä¾‹</h3>
<pre><code class="language-javascript"> const resizeObserver = new ResizeObserver(callback)
 resizeObserver.observe(document.documentElement)
</code></pre>
<h3 id="å¯åŠ¨å…³é—­resizeobserverå®ä¾‹">å¯åŠ¨/å…³é—­ResizeObserverå®ä¾‹</h3>
<pre><code class="language-javascript">// å¼€å§‹è§‚å¯Ÿ
resizeObserver.observe(targetNode)

// é€šè¿‡disconnectæ¥åœæ­¢å…¨éƒ¨è§‚å¯Ÿ
resizeObserver.disconnect()

// åœæ­¢å¯¹ä¸€ä¸ªå…ƒç´ çš„è§‚å¯Ÿ
resizeObserver.unobserve(targetNode)
</code></pre>
<h3 id="resizeobserverçš„callback">ResizeObserverçš„callback</h3>
<pre><code class="language-javascript">// entriesList IntersectionObserverEntryå¯¹è±¡çš„æ•°ç»„
// observer è§‚å¯Ÿè€…çš„å®ä¾‹
const callback = (entries, observer) =&gt; {
    let entrie = entries[0] 
    entrie = {
        // åŒ…å«æ”¹å˜å°ºå¯¸å¤§å°çš„å…ƒç´ çš„contentRectå±æ€§
        contentRect: contentRect {x: 0, y: -76, width: 1, height: 75, top: -76 â€¦}
        // å½“å‰æ”¹å˜å°ºå¯¸å¤§å°çš„å…ƒç´ çš„ Element å¼•ç”¨
        target:  DOM
    } 
}
</code></pre>
        </div>
        
        <div class="my-4">
    
    <a href="/tags/%E5%89%8D%E7%AB%AF/" class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#å‰ç«¯</a>
    
    <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#æ€§èƒ½ä¼˜åŒ–</a>
    
</div>
        
        
        
        
        
        
        
<div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t">
    <div>
        
        <span class="block font-bold">ä¸Šä¸€ç¯‡</span>
        <a href="/posts/2020/2020_summary/" class="block">ã€ç”Ÿæ´»æ€»ç»“ã€‘2020å¹´æ€»ç»“å’Œ2021å¹´å±•æœ›</a>
        
    </div>
    <div class="md:text-right mt-4 md:mt-0">
        
        <span class="block font-bold">ä¸‹ä¸€ç¯‡</span>
        <a href="/posts/2021/about_mylife/" class="block">ã€ç”Ÿæ´»æ„Ÿæ‚Ÿã€‘å†è°ˆç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›-å¸Œæœ›å¯ä»¥è§£å†³é—®é¢˜è€Œä¸æ˜¯è§£å†³é—®é¢˜</a>
        
    </div>
</div>

        
    </div>
    
    <div class="col-span-2">
        
        
        <div class="sticky top-16 z-10 hidden lg:block px-6 py-4  bg-primary-bg ">
    <span class="text-lg font-semibold">æœ¬é¡µå†…å®¹</span>
</div>
<div class="sticky-toc hidden lg:block px-6 pb-6 ">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#éœ€æ±‚æ¥æº">éœ€æ±‚æ¥æº</a></li>
    <li><a href="#å„ç§observer">å„ç§Observer</a></li>
    <li><a href="#mutationobserver">MutationObserver</a>
      <ul>
        <li><a href="#åˆ›å»ºmutationobserveré…ç½®å’Œå®ä¾‹">åˆ›å»ºMutationObserveré…ç½®å’Œå®ä¾‹</a></li>
        <li><a href="#å¯åŠ¨åœæ­¢mutationobserverç›‘å¬">å¯åŠ¨/åœæ­¢MutationObserverç›‘å¬</a></li>
        <li><a href="#mutationobserverçš„calback">MutationObserverçš„calback</a></li>
      </ul>
    </li>
    <li><a href="#intersectionobserver">IntersectionObserver</a>
      <ul>
        <li><a href="#åˆ›å»ºintersectionobserver">åˆ›å»ºIntersectionObserver</a></li>
        <li><a href="#å¯åŠ¨å…³é—­intersectionobserverå®ä¾‹">å¯åŠ¨/å…³é—­IntersectionObserverå®ä¾‹</a></li>
        <li><a href="#intersectionobserverçš„callback">IntersectionObserverçš„callback</a></li>
        <li><a href="#intersectionobserverå®ç°æ— é™æ»šåŠ¨">IntersectionObserverå®ç°æ— é™æ»šåŠ¨</a></li>
      </ul>
    </li>
    <li><a href="#performanceobserver">PerformanceObserver</a></li>
    <li><a href="#resizeobserver">ResizeObserver</a>
      <ul>
        <li><a href="#åˆ›å»ºresizeobserverå®ä¾‹">åˆ›å»ºResizeObserverå®ä¾‹</a></li>
        <li><a href="#å¯åŠ¨å…³é—­resizeobserverå®ä¾‹">å¯åŠ¨/å…³é—­ResizeObserverå®ä¾‹</a></li>
        <li><a href="#resizeobserverçš„callback">ResizeObserverçš„callback</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        enableStickyToc();
    });
</script>
        
    </div>
    

    
    
    <div
        class="col-span-2  lg:col-span-6 bg-secondary-bg rounded p-6">
        <h2 class="text-lg font-semibold mb-4">ç›¸å…³</h2>
        <div class="content">
            
            <a href="/posts/2021/vue_principle_01/">ã€åŸç†æ¢ç´¢ã€‘vue.jsè¶…çº§å…¨å®¶æ¡¶--æ¡†æ¶æ•´ä½“æºç åˆ†æåŠæŠ€æœ¯å­¦ä¹ æ¸…å•</a>
            <br />
            
            <a href="/posts/2021/snabbdom_source/">ã€æŠ€æœ¯åˆ†äº«ã€‘virtual DOMçš„æ€è€ƒåŠsnabbdomåº“æºç è§£è¯»</a>
            <br />
            
            <a href="/posts/2021/input_html/">ã€æŠ€æœ¯åˆ†äº«ã€‘äº§å“è¦åœ¨è¾“å…¥æ¡†è¾“å…¥é«˜äº®æ–‡å­—ï¼ï¼Ÿé™¤äº†ä½¿ç”¨MDè§£æå™¨ï¼Œè‡ªå·±æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†</a>
            <br />
            
            <a href="/posts/2021/designpatterns/">ã€æŠ€æœ¯åˆ†äº«ã€‘è§‚å¯Ÿè€…æ¨¡å¼VSå‘å¸ƒ/è®¢é˜…æ¨¡å¼</a>
            <br />
            
            <a href="/posts/2020/scroll_fix/">ã€æŠ€æœ¯ç¬”è®°ã€‘vueä¸­æ»‘åŠ¨äº‹ä»¶è§¦å‘æ€ä¹ˆå¤±çµäº†ï¼Ÿï¼</a>
            <br />
            
            <a href="/posts/2020/functional_programming/">ã€æŠ€æœ¯åˆ†äº«ã€‘å‡½æ•°å¼ç¼–ç¨‹å…¥é—¨åˆæ¢</a>
            <br />
            
        </div>
    </div>
    
</div>
<script>
    document.addEventListener('DOMContentLoaded', ()=>{
        hljs.initHighlightingOnLoad();
    })
</script>

      </div>
    </div>
    
  </main>
  <footer class="pl-scrollbar">
    <div class="w-full max-w-screen-xl mx-auto"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text">&copy; 2019-2021   gzg1023 &middot;  Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div></div>
  </footer>
</body>

</html>